[apéndice]
[[apéndice_soluciones]]
== Soluciones

=== <<capítulo_campos_finitos>>: Campos finitos

include::code-ch01/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
clase FieldElement:
...
include::code-ch01/respuestas.py[tag=respuesta1,indent=4]
----

include::code-ch01/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
include::code-ch01/respuestas.py[tag=respuesta2,indent=0]
----

include::code-ch01/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
clase FieldElement:
...
include::code-ch01/respuestas.py[tag=respuesta3,indent=4]
----

include::code-ch01/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
include::code-ch01/respuestas.py[tag=respuesta4,indent=0]
----

include::code-ch01/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
include::code-ch01/respuestas.py[tag=respuesta5,indent=0]
----

Cuando se ordenan, los resultados son siempre el mismo conjunto.

include::code-ch01/answers.py[tag=exercise6,indent=0]

[fuente,python]
----
clase FieldElement:
...
include::code-ch01/respuestas.py[tag=respuesta6,indent=4]
----

include::code-ch01/answers.py[tag=exercise7,indent=0]

[fuente,python]
----
include::code-ch01/respuestas.py[tag=respuesta7,indent=0]
----

include::code-ch01/answers.py[tag=exercise8,indent=0]

[fuente,python]
----
include::code-ch01/respuestas.py[tag=respuesta8,indent=0]
----

include::code-ch01/answers.py[tag=exercise9,indent=0]

[fuente,python]
----
clase FieldElement:
...
include::code-ch01/respuestas.py[tag=respuesta9,indent=4]
----

=== <<capítulo_curvas_elípticas>>: Curvas elípticas

include::code-ch02/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
include::code-ch02/respuestas.py[tag=respuesta1,indent=0]
----

include::code-ch02/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
clase Punto:
...
include::code-ch02/respuestas.py[tag=respuesta2,indent=4]
----

include::code-ch02/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
clase Punto:
...
include::code-ch02/respuestas.py[tag=respuesta3,indent=4]
----

include::code-ch02/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
include::code-ch02/respuestas.py[tag=respuesta4,indent=0]
----

include::code-ch02/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
clase Punto:
...
    def __add__(self, other):
    ...
include::code-ch02/respuestas.py[tag=respuesta5,indent=4]
----

include::code-ch02/answers.py[tag=exercise6,indent=0]

[fuente,python]
----
include::code-ch02/respuestas.py[tag=respuesta6,indent=0]
----

include::code-ch02/answers.py[tag=exercise7,indent=0]

[fuente,python]
----
clase Punto:
...
    def __add__(self, other):
    ...
include::code-ch02/respuestas.py[tag=respuesta7,indent=4]
----

=== <<capítulo_criptografía_de_curvas_elípticas>>: Criptografía de curvas elípticas

include::code-ch03/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
include::code-ch03/respuestas.py[tag=respuesta1,indent=0]
----

include::code-ch03/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
include::code-ch03/respuestas.py[tag=respuesta2,indent=0]
----

include::code-ch03/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
include::code-ch03/respuestas.py[tag=respuesta3,indent=0]
----

include::code-ch03/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
include::code-ch03/respuestas.py[tag=respuesta4,indent=0]
----

include::code-ch03/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
include::code-ch03/respuestas.py[tag=respuesta5,indent=0]
----

include::code-ch03/answers.py[tag=exercise6,indent=0]

[fuente,python]
----
include::code-ch03/respuestas.py[tag=respuesta6,indent=0]
----

include::code-ch03/answers.py[tag=exercise7,indent=0]

[fuente,python]
----
include::code-ch03/respuestas.py[tag=respuesta7,indent=0]
----

=== <<capítulo_serialización>>: Serialización

include::code-ch04/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
include::code-ch04/respuestas.py[tag=respuesta1,indent=0]
----

include::code-ch04/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
include::code-ch04/respuestas.py[tag=respuesta2,indent=0]
----

include::code-ch04/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
include::code-ch04/respuestas.py[tag=respuesta3,indent=0]
----

include::code-ch04/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
include::code-ch04/respuestas.py[tag=respuesta4,indent=0]
----

include::code-ch04/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
include::code-ch04/respuestas.py[tag=respuesta5,indent=0]
----

include::code-ch04/answers.py[tag=exercise6,indent=0]

[fuente,python]
----
include::code-ch04/respuestas.py[tag=respuesta6,indent=0]
----

include::code-ch04/answers.py[tag=exercise7,indent=0]

[fuente,python]
----
include::code-ch04/respuestas.py[tag=respuesta7,indent=0]
----

include::code-ch04/answers.py[tag=exercise8,indent=0]

[fuente,python]
----
include::code-ch04/respuestas.py[tag=respuesta8,indent=0]
----

include::code-ch04/answers.py[tag=exercise9,indent=0]

[fuente,python]
----
include::code-ch04/respuestas.py[tag=respuesta9,indent=0]
----

=== <<capítulo_tx_parsing>>: Transacciones

include::code-ch05/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch05/respuestas.py[tag=respuesta1,indent=0]
----

include::code-ch05/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch05/respuestas.py[tag=respuesta2.1]
...

clase TxIn:
...
include::code-ch05/respuestas.py[tag=respuesta2.2, indent=4]
----

include::code-ch05/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch05/respuestas.py[tag=respuesta3.1]
...

clase TxOut:
...
include::code-ch05/respuestas.py[tag=respuesta3.2, indent=4]
----

include::code-ch05/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch05/respuestas.py[tag=respuesta4,indent=0]
----

include::code-ch05/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
include::code-ch05/respuestas.py[tag=respuesta5,indent=0]
----

include::code-ch05/answers.py[tag=exercise6,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch05/respuestas.py[tag=respuesta6,indent=4]
----

=== <<capítulo_script>>: Script

include::code-ch06/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
include::code-ch06/respuestas.py[tag=respuesta1,indent=0]
----

include::code-ch06/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
include::code-ch06/respuestas.py[tag=respuesta2,indent=0]
----

include::code-ch06/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
include::code-ch06/respuestas.py[tag=respuesta3,indent=0]
----

`OP_2` o `52` satisfará la ecuación __x__^2^ + _x_ - 6 = 0.

include::code-ch06/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
include::code-ch06/respuestas.py[tag=respuesta4,indent=0]
----
<1> `collision1` y `collision2` son de las preimágenes SHA-1 que http://bit.ly/2HZF3om[Google encontró para colisionar].

Esto busca una colisión SHA-1. La única forma de satisfacer este script es dar `x` e `y` de forma que `x≠y` pero `sha1(x)=sha1(y)`.

=== <<capítulo_tx>>: Creación y validación de transacciones

include::code-ch07/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch07/respuestas.py[tag=respuesta1,indent=4]
----

include::code-ch07/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch07/respuestas.py[tag=respuesta2,indent=4]
----

include::code-ch07/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch07/respuestas.py[tag=respuesta3,indent=4]
----

include::code-ch07/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
include::code-ch07/respuestas.py[tag=respuesta4,indent=0]
----

include::code-ch07/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
include::code-ch07/respuestas.py[tag=respuesta5,indent=0]
----

=== <<capítulo_p2sh>>: Pay to Script Hash

include::code-ch08/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
include::code-ch08/respuestas.py[tag=respuesta1,indent=0]
----

include::code-ch08/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
include::code-ch08/respuestas.py[tag=respuesta2,indent=0]
----

include::code-ch08/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
include::code-ch08/respuestas.py[tag=respuesta3,indent=0]
----

[role="pagebreak-before"]
include::code-ch08/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
include::code-ch08/respuestas.py[tag=respuesta4,indent=0]
----

include::code-ch08/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch08/respuestas.py[tag=respuesta5,indent=4]
----

=== <<capítulo_bloques>>: Bloques

include::code-ch09/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch09/respuestas.py[tag=respuesta1,indent=4]
----

include::code-ch09/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
clase Tx:
...
include::code-ch09/respuestas.py[tag=respuesta2,indent=4]
----

include::code-ch09/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
clase Block:
...
include::code-ch09/respuestas.py[tag=respuesta3,indent=4]
----

[role="pagebreak-before"]
include::code-ch09/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
clase Block:
...
include::code-ch09/respuestas.py[tag=respuesta4,indent=4]
----

include::code-ch09/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
clase Block:
...
include::code-ch09/respuestas.py[tag=respuesta5,indent=4]
----

include::code-ch09/answers.py[tag=exercise6,indent=0]

[fuente,python]
----
clase Block:
...
include::code-ch09/respuestas.py[tag=respuesta6,indent=4]
----

include::code-ch09/answers.py[tag=exercise7,indent=0]

[fuente,python]
----
clase Block:
...
include::code-ch09/respuestas.py[tag=respuesta7,indent=4]
----

include::code-ch09/answers.py[tag=exercise8,indent=0]

[fuente,python]
----
clase Block:
...
include::code-ch09/respuestas.py[tag=respuesta8,indent=4]
----

include::code-ch09/answers.py[tag=exercise9,indent=0]

[fuente,python]
----
include::code-ch09/respuestas.py[tag=respuesta9,indent=0]
----

include::code-ch09/answers.py[tag=exercise10,indent=0]

[fuente,python]
----
clase Block:
...
include::code-ch09/respuestas.py[tag=respuesta10,indent=4]
----

include::code-ch09/answers.py[tag=exercise11,indent=0]

[fuente,python]
----
clase Block:
...
include::code-ch09/respuestas.py[tag=respuesta11,indent=4]
----

include::code-ch09/answers.py[tag=exercise12,indent=0]

[fuente,python]
----
include::code-ch09/respuestas.py[tag=respuesta12,indent=0]
----

include::code-ch09/answers.py[tag=exercise13,indent=0]

[fuente,python]
----
include::code-ch09/respuestas.py[tag=respuesta13,indent=0]
----

=== <<capítulo_de_redes>>: Redes

include::code-ch10/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
include::code-ch10/respuestas.py[tag=respuesta1,indent=0]
----

include::code-ch10/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
clase NetworkEnvelope:
...
include::code-ch10/respuestas.py[tag=respuesta2,indent=4]
----

include::code-ch10/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
clase NetworkEnvelope:
...
include::code-ch10/respuestas.py[tag=respuesta3,indent=4]
----

include::code-ch10/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
clase VersionMessage:
...
include::code-ch10/respuestas.py[tag=respuesta4,indent=4]
----

include::code-ch10/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
clase SimpleNode:
...
include::code-ch10/respuestas.py[tag=respuesta5,indent=4]
----

include::code-ch10/answers.py[tag=exercise6,indent=0]

[fuente,python]
----
clase GetHeadersMessage:
...
include::code-ch10/answers.py[tag=answer6,indent=4]
----

=== <<capítulo_spv>>: Verificación de pagos simplificada

include::code-ch11/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
include::code-ch11/respuestas.py[tag=respuesta1,indent=0]
----

include::code-ch11/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
include::code-ch11/respuestas.py[tag=respuesta2,indent=0]
----

include::code-ch11/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
include::code-ch11/respuestas.py[tag=respuesta3,indent=0]
----

include::code-ch11/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
clase Block:
...
include::code-ch11/respuestas.py[tag=respuesta4,indent=4]
----

include::code-ch11/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
include::code-ch11/respuestas.py[tag=respuesta5,indent=0]
----

include::code-ch11/answers.py[tag=exercise6,indent=0]

[fuente,python]
----
clase MerkleBlock:
...
include::code-ch11/answers.py[tag=answer6,indent=4]
----

include::code-ch11/answers.py[tag=exercise7,indent=0]

[fuente,python]
----
clase MerkleBlock:
...
include::code-ch11/answers.py[tag=answer7,indent=4]
----

=== <<capítulo_bloom_filters>>: Filtros de Bloom

include::code-ch12/answers.py[tag=exercise1,indent=0]

[fuente,python]
----
include::code-ch12/respuestas.py[tag=respuesta1,indent=0]
----

include::code-ch12/answers.py[tag=exercise2,indent=0]

[fuente,python]
----
include::code-ch12/respuestas.py[tag=respuesta2,indent=0]
----

include::code-ch12/answers.py[tag=exercise3,indent=0]

[fuente,python]
----
clase BloomFilter:
...
include::code-ch12/respuestas.py[tag=respuesta3,indent=4]
----

include::code-ch12/answers.py[tag=exercise4,indent=0]

[fuente,python]
----
clase BloomFilter:
...
include::code-ch12/answers.py[tag=answer4,indent=4]
----

include::code-ch12/answers.py[tag=exercise5,indent=0]

[fuente,python]
----
clase GetDataMessage:
...
include::code-ch12/answers.py[tag=answer5,indent=4]
----

include::code-ch12/answers.py[tag=exercise6,indent=0]

[fuente,python]
----
include::code-ch12/respuestas.py[tag=respuesta6,indent=0]
----
